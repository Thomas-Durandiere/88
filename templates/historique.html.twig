{% extends 'base.html.twig' %}

{% block title %}Historique{% endblock %}

{% block body %}
    {% if is_granted("ROLE_ADMIN") %}
        <div class="bandeauLog darkMode">
            <a class="boutAct" href="{{ path('app_ajouter')}}" >Ajouter</a>
            <a class="boutAct" href="{{ path('app_messages')}}" >Messages</a>
            <a href="{{ path('app_logout')}}" ><img class="deco" id="iconDeco" src="{{ asset('images/logo/deco.png') }}" data-light="{{ asset('images/logo/deco.png') }}" 
                data-dark="{{ asset('images/logo/decoB.png') }}" alt="Déconnexion" title="Déconnexion"></a>
        </div>
            {% elseif is_granted("ROLE_USER") %} 
        <div class="bandeauLog darkMode">
            <a class="boutAct" type="button" href="{{ path('app_panier')}}" >Panier</a>
            <a class="boutAct" type="button" href="{{ path('app_history')}}" >Historique</a>
            <a href="{{ path('app_logout')}}" ><img class="deco" id="iconDeco" src="{{ asset('images/logo/deco.png') }}" data-light="{{ asset('images/logo/deco.png') }}" 
                data-dark="{{ asset('images/logo/decoB.png') }}" alt="Déconnexion" title="Déconnexion"></a>
        </div>
    {% endif %}

        <h2 id="h2Infos">Historique</h2>

    <div class="affHist">        

        {% if paidOrders is not empty %}
        
            {% for order in paidOrders %}
                <div class="history darkMode">            
                    
                    <p>{{ order.getDate | date('d/M/Y H:i') }}</p>
                    
                    {% for op in order.getOrderProducts %}
                
                    <div class="panierArt darkMode" data-op-id="{{ op.id }}">
                        <div class="cardPanier">
                            <img src="{{ op.getProducts.pic }}">
                            <h3>{{ op.getProducts.name }}</h3>
                            <span class="quantity">{{ op.getQuantity }}</span>
                            <p class="line-total">{{ (op.getQuantity * op.getPriceUnit)|number_format(2, '.', ',') }} €</p>
                        </div>
                    </div>
                    {% endfor %}

                    <p>Total commande : {{ order.getTotalPrice }} €</p>
                </div>   

                
                    
            {% endfor %}

        {% else %}
            <h2>Votre historique est vide</h2>
        {% endif %}

    </div>


    <a class="HP" href="#">Haut de page</a>
    
{% endblock %}